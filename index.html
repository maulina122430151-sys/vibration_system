  
<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Sistem Deteksi Getaran Bed Pasien Epilepsi Berbasis ROS2 menggunakan ESP8266, SW-402, dan Buzzer</title>
  <meta name="description" content="Dokumentasi Sistem Alarm Getaran berbasis ROS2 & ESP8266 ‚Äî tampilan tema medis tosca, responsif.">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    /* Palette: tosca / teal medical theme */
    :root{--bg:#e6fbf7;--primary:#2bbbad;--accent:#0b7f77;--card:#ffffff;--muted:#2b4750;--glass:rgba(11,127,119,0.06);--code-bg:#f1fcfb;--shadow:0 8px 30px rgba(43,71,80,0.08);--radius:12px}
    html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  font-family: 'Poppins', Inter, system-ui, Arial;
  color: var(--muted);
  background: linear-gradient(180deg,var(--bg),#dff7f4);
}
    .container{max-width:1100px;margin:0 auto;padding:20px;max-height:calc(100vh - 56px);overflow:auto}
    /* Hide native scrollbars but keep scrolling functional */
    .container, body {
      -ms-overflow-style: none; /* IE and Edge */
      scrollbar-width: none; /* Firefox */
    }

    /* Layout */
    main{display:block;max-width:980px;margin:0 auto;gap:20px}
    .content{background:var(--card);padding:18px;border-radius:var(--radius);box-shadow:var(--shadow)}
    .sidebar{position:sticky;top:20px;background:var(--card);padding:16px;border-radius:12px;box-shadow:var(--shadow)}
    h2{color:var(--accent);margin:6px 0 10px}
    .muted{color:var(--muted)}
    nav.toc{display:flex;flex-direction:row;gap:8px;flex-wrap:wrap;margin-bottom:12px;justify-content:center}
    nav.toc a{background:var(--glass);padding:8px 10px;border-radius:10px;color:var(--accent);text-decoration:none;font-size:13px}

    pre{background:var(--code-bg);padding:12px;border-radius:10px;overflow:auto;color:var(--muted);border:1px solid rgba(11,127,119,0.06)}

    /* Hero + features */
    .hero{background:linear-gradient(90deg, rgba(11,127,119,0.08), rgba(43,187,171,0.06));padding:22px;border-radius:14px;text-align:center;margin-bottom:14px}
    .hero h1{font-size:22px;margin:0 0 6px}
    .hero p.lead{font-size:14px;color:var(--muted);margin:0 0 12px}
    .badges{display:flex;gap:8px;justify-content:center;flex-wrap:wrap;margin-bottom:6px}
    .badge{background:var(--card);border:1px solid rgba(11,127,119,0.08);padding:6px 10px;border-radius:999px;color:var(--accent);font-weight:600;font-size:13px}

    .features{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin:16px 0}
    .feature-card{background:linear-gradient(180deg,var(--card),#fbfffe);padding:14px;border-radius:12px;text-align:center;border:1px solid rgba(11,127,119,0.04);box-shadow:0 6px 18px rgba(11,127,119,0.04)}
    .feature-card h4{margin:8px 0 6px;color:var(--accent)}
    .feature-icon{width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,var(--primary),var(--accent));display:inline-flex;align-items:center;justify-content:center;color:white;font-weight:700}
    .sec-icon{display:inline-flex;align-items:center;justify-content:center;margin-right:8px;vertical-align:middle}
    .sec-icon svg{width:18px;height:18px}

    /* fade-in animation */
    .fade-in{opacity:0;transform:translateY(12px);transition:opacity .6s ease, transform .6s ease}
    .fade-in.visible{opacity:1;transform:none}

    /* additional animations */
    @keyframes fadeUp { from { opacity:0; transform: translateY(14px); } to { opacity:1; transform:none } }
    @keyframes slideInRight { from { opacity:0; transform: translateX(12px); } to { opacity:1; transform:none } }
    @keyframes pulse { 0%{ transform:scale(1) }50%{ transform:scale(1.04) }100%{ transform:scale(1)} }

    .animate-stagger{opacity:0;transform:translateY(8px);} 
    .animate-stagger.visible{animation:fadeUp .6s both}

    /* header shrink on scroll */
    header{transition:all .28s ease;display:flex;align-items:center;justify-content:center;padding:12px 0}
    header.scrolled{transform:translateY(-2px);box-shadow:0 10px 30px rgba(11,127,119,0.06);padding-top:6px;padding-bottom:6px}
    header.scrolled .logo{width:60px;height:60px}

    /* floating TOC slide-in */
    .toc-float{transform:translateX(10px);opacity:0;transition:transform .45s cubic-bezier(.2,.9,.2,1),opacity .45s ease}
    .toc-float.visible{transform:none;opacity:1}

    /* nav link hover */
    nav.toc a{transition:transform .18s ease, background .18s ease}
    nav.toc a:hover{transform:translateY(-4px);background:rgba(11,127,119,0.12)}

    /* h2 icon entrance */
    .sec-icon{opacity:0;transform:translateY(-6px);transition:opacity .45s ease, transform .45s ease}
    h2 .sec-icon{opacity:1;transform:none}

    .feature-card:hover{transform:translateY(-6px) scale(1.02);box-shadow:0 14px 30px rgba(11,127,119,0.12)}

    /* code copy button */
    .pre-wrap{position:relative}
    .copy-btn{position:absolute;top:8px;right:8px;background:var(--accent);color:white;border:none;padding:6px 8px;border-radius:8px;cursor:pointer;font-size:12px}

    /* floating Table of Contents */
    .toc-float{position:fixed;right:18px;top:120px;background:var(--card);padding:10px;border-radius:10px;box-shadow:var(--shadow);border:1px solid rgba(11,127,119,0.06);display:flex;flex-direction:column;gap:6px;z-index:60}
    .toc-float a{color:var(--accent);text-decoration:none;font-weight:600;padding:6px 8px;border-radius:8px}
    @media(max-width:900px){.toc-float{display:none}}

    @media (max-width:900px){
      header{flex-direction:column;align-items:center}
      header .brand h1{font-size:20px}
      .features{grid-template-columns:1fr}
    }

    /* Center brand content */
    .brand{display:flex;align-items:center;gap:12px}
    .brand > div{display:block;text-align:center}
    header .brand h1, header .brand p.lead{margin:0;text-align:center}
    /* Indented content for Cara Kerja */
    .indent{margin-left:36px}
    .indent pre{margin-left:0}
    @media (max-width:600px){.indent{margin-left:12px}}
    /* Mobile optimizations */
    @media (max-width:600px){
      html,body{padding:12px}
      .container{padding:12px;max-height:none}
      header .brand h1{font-size:18px}
      .hero{padding:16px;border-radius:10px}
      .hero h1{font-size:18px}
      .hero p.lead{font-size:13px}
      .badges{gap:6px}
      .feature-card{padding:12px}
      .feature-icon{width:40px;height:40px}
      .feature-icon svg{width:18px;height:18px}
      pre{font-size:12px;white-space:pre-wrap;word-break:break-word}
      nav.toc{flex-direction:column;align-items:center}
      nav.toc a{display:block;width:100%;text-align:center;padding:10px 12px}
    }
    code{font-family:Consolas,monaco,monospace;font-size:13px}
    .tree{font-family:monospace;background:linear-gradient(180deg,var(--code-bg),#f7fffe);padding:12px;border-radius:10px;color:var(--muted);border:1px solid rgba(11,127,119,0.06)}

    table{width:100%;border-collapse:collapse;margin-top:8px}
    th, td{padding:10px 8px;text-align:left;border-bottom:1px solid rgba(43,71,80,0.06)}

    /* Members table styling */
    .table-wrap{overflow:auto;border-radius:12px;margin-top:10px}
    .members{width:100%;border-collapse:separate;border-spacing:0;background:linear-gradient(180deg,#ffffff,#fbfffe);box-shadow:0 10px 30px rgba(11,127,119,0.04);border-radius:10px;overflow:hidden}
    .members thead th{background:linear-gradient(90deg,var(--primary),var(--accent));color:white;padding:12px 14px;font-weight:700;border-bottom:none;text-align:left}
    .members tbody td{padding:12px 14px;background:transparent;border-bottom:1px solid rgba(11,127,119,0.06)}
    .members tbody tr:hover td{background:rgba(11,127,119,0.03)}
    .members tbody tr:last-child td{border-bottom:none}
    @media(max-width:600px){
      .members thead th{display:none}
      .members tbody td{display:block;padding:10px 12px}
      .members tbody tr{margin-bottom:10px;border-radius:8px;background:var(--card);box-shadow:0 6px 16px rgba(11,127,119,0.03);border:1px solid rgba(11,127,119,0.03);overflow:hidden}
      .members tbody td:before{content:attr(data-label);font-weight:600;display:block;color:var(--accent);margin-bottom:6px}
    }

    /* Issues table (Kendala) with tosca border */
    .issues{width:100%;border-collapse:collapse;margin-top:8px;border:1px solid rgba(43,187,171,0.12);border-radius:10px;overflow:hidden;box-shadow:0 10px 30px rgba(43,187,171,0.04)}
    .issues th,.issues td{padding:12px 14px;text-align:left;border-bottom:1px solid rgba(43,187,171,0.06)}
    .issues thead th{background:linear-gradient(90deg,var(--primary),var(--accent));color:white;padding:12px 14px;font-weight:700;border-bottom:none;text-align:left}
    @media(max-width:600px){
      .issues thead{display:none}
      .issues tbody td{display:block;padding:10px 12px;border:none;border-bottom:1px solid rgba(11,127,119,0.06)}
      .issues tbody tr{margin-bottom:10px;border-radius:8px;background:var(--card);box-shadow:0 6px 16px rgba(11,127,119,0.03);border:1px solid rgba(11,127,119,0.03);overflow:hidden}
      .issues tbody td:before{content:attr(data-label);font-weight:600;display:block;color:var(--accent);margin-bottom:6px}
    }

    /* mobile */
    @media (max-width:900px){
      main{grid-template-columns:1fr}
      .sidebar{position:static}
      header{flex-direction:column;align-items:flex-start}
      .logo{width:56px;height:56px}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>üìò Sistem Deteksi Getaran Bed Pasien Epilepsi Berbasis ROS2 menggunakan ESP8266, SW-402, dan Buzzer üè•</h1>
          <p class="lead">‚Äî SW-402 ‚Ä¢ ESP8266 ‚Ä¢ ROS2 ‚Ä¢ Buzzer ‚Äî</p>
        </div>
      </div>
    </header>

    <!-- Hero removed per request -->

    <nav class="toc">
      <a href="#desc">Deskripsi</a>
      <a href="#arch">Arsitektur</a>
      <a href="#howto">Cara Kerja</a>
      <a href="#structure">Struktur Folder</a>
      <a href="#install">Instalasi</a>
      <a href="#esp">ESP8266</a>
      <a href="#ros2">Kode ROS2</a>
      <a href="#run">Menjalankan</a>
    </nav>

    <main>
      <section class="content fade-in">
        <a id="desc"></a>
        <h2>üß≠ Deskripsi Proyek</h2>
        <p>Proyek ini membangun sistem deteksi getaran menggunakan modul ESP8266, sensor SW-402, dan buzzer berbasis ROS 2 dengan arsitektur Publisher‚ÄìSubscriber. ESP8266 membaca data sensor dan mengirimkan informasi ke komputer melalui komunikasi serial. Node ROS2 kemudian memproses data dan mengaktifkan buzzer apabila terdeteksi getaran.</p>
        <p>Sistem ini berguna untuk mendeteksi getaran pada bed/kasur pasien pengidap epilepsi. Epilepsi adalah gangguan pada sistem saraf pusat yang menyebabkan aktivitas listrik otak menjadi tidak normal sehingga memicu kejang berulang. Kejang pada epilepsi dapat berupa gerakan tubuh tak terkontrol, kaku, atau tersentak-sentak, tetapi bisa juga muncul sebagai tatapan kosong, hilang kesadaran sesaat, atau sensasi aneh sebelum serangan. Pada keadaan kejang, pasien memerlukan penanganan cepat karena gerakan tak terkontrol dapat menyebabkan cedera, gangguan pernapasan, atau memburuknya kondisi medis.</p>
        <p>Oleh karena itu, sistem pendeteksi getaran pada bed atau kasur pasien sangat dibutuhkan untuk mengidentifikasi aktivitas kejang sedini mungkin. Sensor getaran dapat mendeteksi pola gerakan tidak normal pada tubuh pasien dan memicu alarm bagi tenaga medis atau keluarga sehingga respons pertolongan dapat diberikan segera. Dengan deteksi dini ini, risiko komplikasi dapat ditekan dan keselamatan pasien lebih terjamin.</p>

        <hr>
          <h2>ü§ñ Anggota Kelompok</h2>
          <div class="table-wrap">
            <table class="members">
              <thead>
                <tr><th>Nama</th><th>NIM</th></tr>
              </thead>
              <tbody>
                <tr><td data-label="Nama">Maulina Adelia Putri</td><td data-label="NIM">122430151</td></tr>
                <tr><td data-label="Nama">Lasma Keren J. Marbun</td><td data-label="NIM">122430154</td></tr>
                <tr><td data-label="Nama">Elisabeth Tampubolon</td><td data-label="NIM">122430104</td></tr>
              </tbody>
            </table>
          </div>
        
        <hr>
        <a id="arch"></a>
        <h2>üì° Arsitektur Sistem</h2>
        <h3>Hardware</h3>
        <ul>
          <li>Sensor getaran SW-402</li>
          <li>ESP8266 (NodeMCU)</li>
          <li>Buzzer aktif</li>
          <li>Kabel USB data</li>
          <li>Komputer (Windows)</li>
        </ul>
        <h3>Software</h3>
        <ul>
          <li>ROS 2 (melalui environment PIXI)</li>
          <li>Python 3 (pyserial)</li>
          <li>Arduino IDE</li>
          <li>Colcon</li>
        </ul>

        <hr>
        <a id="howto"></a>
        <h2>üîß Cara Kerja</h2>
        <div class="indent">
          <p>ESP8266 membaca sensor SW-402</p>
          <p>Mengirim data serial dengan format:</p>
          <pre><code>VIB:1  ‚Üí getaran terdeteksi
VIB:0  ‚Üí tidak ada getaran</code></pre>
          <p>Node Publisher membaca port serial ‚Üí publish topic <code>/vibration</code></p>
          <p>Node Subscriber menerima <code>/vibration</code> ‚Üí mengirim <code>/buzzer_cmd</code></p>
          <p>Node Publisher mengirim perintah serial ke ESP8266:</p>
          <pre><code>BUZZ:ON
BUZZ:OFF</code></pre>
          <p>ESP8266 menyalakan / mematikan buzzer.</p>
        </div>

        <hr>
        <h2 id="structure">üìÇ Struktur Folder</h2>
        <pre class="tree">ros2_ws/
    ‚îî‚îÄ‚îÄ src/
      ‚îî‚îÄ‚îÄ vibration_system/
        ‚îú‚îÄ‚îÄ package.xml
        ‚îú‚îÄ‚îÄ setup.py
        ‚îî‚îÄ‚îÄ vibration_system/
          ‚îú‚îÄ‚îÄ __init__.py
          ‚îú‚îÄ‚îÄ publisher_vibration.py
          ‚îî‚îÄ‚îÄ subscriber_buzzer.py</pre>

        <h2 id="esp">üîå Program ESP8266 (Arduino IDE)</h2>
        <p>Pin: <strong>SENSOR=D5</strong>, <strong>BUZZER=D6</strong>.</p>
        <pre id="espCode">#define SENSOR_PIN D5
#define BUZZER_PIN D6

void setup() {
  Serial.begin(115200);
  pinMode(SENSOR_PIN, INPUT);
  pinMode(BUZZER_PIN, OUTPUT);
}

void loop() {
  int vib = digitalRead(SENSOR_PIN);
  Serial.printf("VIB:%d\n", vib);

  if (Serial.available()) {
    String cmd = Serial.readStringUntil('\n');
    if (cmd == "BUZZ:ON") digitalWrite(BUZZER_PIN, HIGH);
    if (cmd == "BUZZ:OFF") digitalWrite(BUZZER_PIN, LOW);
  }

  delay(10);
}</pre>

        <hr>
        <h2 id="install">‚öôÔ∏è Instalasi dan Persiapan</h2>
        <ol>
          <li><strong>Clone repositori</strong>
            <pre><code>git clone https://github.com/username/vibration_system.git
cd vibration_system</code></pre>
            <p><em>(Ganti <code>username</code> sesuai akun Anda.)</em></p>
          </li>
          <li><strong>Masuk ke environment PIXI</strong>
            <pre><code>cd C:\pixi_ws
pixi shell</code></pre>
          </li>
          <li><strong>Build ROS2 Workspace</strong>
            <pre><code>cd C:\pixi_ws\ros2_ws
colcon build</code></pre>
            <p>Aktifkan environment:</p>
            <pre><code>.\install\setup.ps1</code></pre>
          </li>
        </ol>

      <hr>
      <a id="ros2"></a>
    <h2>ü§ñ Kode ROS2</h2>

    <h3>1Ô∏è‚É£ publisher_vibration.py (pemegang COM)</h3>
    <p>Fungsi:</p>
    <ul>
      <li>membaca serial COM</li>
      <li>publish <code>/vibration</code></li>
      <li>menerima <code>/buzzer_cmd</code></li>
      <li>kirim <code>BUZZ:ON</code>/<code>BUZZ:OFF</code> ke ESP8266</li>
    </ul>
    <pre><code>import rclpy
from rclpy.node import Node
from std_msgs.msg import Bool
import serial

class VibrationPublisher(Node):
  def __init__(self):
    super().__init__('vibration_publisher')

    self.ser = serial.Serial('COM10', 115200, timeout=1)
    self.pub = self.create_publisher(Bool, 'vibration', 10)
    self.sub_cmd = self.create_subscription(
      Bool, 'buzzer_cmd', self.buzzer_callback, 10
    )
    self.timer = self.create_timer(0.1, self.read_serial)

  def read_serial(self):
    if self.ser.in_waiting:
      line = self.ser.readline().decode(errors='ignore').strip()
      if line.startswith("VIB:"):
        msg = Bool()
        msg.data = (line.split(":")[1] == "1")
        self.pub.publish(msg)
        self.get_logger().info(f"[PUBLISH] Vibration: {msg.data}")

  def buzzer_callback(self, msg):
    if msg.data:
      self.ser.write(b"BUZZ:ON\n")
      self.get_logger().info("[SEND] BUZZ:ON")
    else:
      self.ser.write(b"BUZZ:OFF\n")
      self.get_logger().info("[SEND] BUZZ:OFF")

def main(args=None):
  rclpy.init(args=args)
  node = VibrationPublisher()
  rclpy.spin(node)
  node.destroy_node()
  rclpy.shutdown()
</code></pre>

    <h3>2Ô∏è‚É£ subscriber_buzzer.py</h3>
    <p>Fungsi:</p>
    <ul>
      <li>menerima <code>/vibration</code></li>
      <li>publish <code>/buzzer_cmd</code></li>
    </ul>
    <pre><code>import rclpy
from rclpy.node import Node
from std_msgs.msg import Bool

class BuzzerSubscriber(Node):
  def __init__(self):
    super().__init__('buzzer_subscriber')

    self.sub = self.create_subscription(
      Bool, 'vibration', self.cb, 10
    )
    self.pub_cmd = self.create_publisher(Bool, 'buzzer_cmd', 10)
    self.get_logger().info("Subscriber started.")

  def cb(self, msg):
    cmd = Bool()
    if msg.data:
      self.get_logger().info("[EVENT] Vibration detected ‚Üí buzzer ON")
      cmd.data = True
    else:
      self.get_logger().info("[EVENT] No vibration ‚Üí buzzer OFF")
      cmd.data = False
    self.pub_cmd.publish(cmd)

def main(args=None):
  rclpy.init(args=args)
  node = BuzzerSubscriber()
  rclpy.spin(node)
  node.destroy_node()
  rclpy.shutdown()
</code></pre>

    <hr>
    <h2 id="run">‚ñ∂Ô∏è Menjalankan Sistem</h2>
    <h4>Terminal 1 ‚Äì Publisher (serial manager)</h4>
    <pre>cd C:\pixi_ws\ros2_ws
pixi shell
.\install\setup.ps1
ros2 run vibration_system publisher_vibration</pre>

    <h4>Terminal 2 ‚Äì Subscriber</h4>
    <pre>cd C:\pixi_ws\ros2_ws
pixi shell
.\install\setup.ps1
ros2 run vibration_system subscriber_buzzer</pre>

    <hr>
    <h2>üß™ Output yang Diharapkan</h2>
    <div style="display:flex;gap:10px;flex-wrap:wrap">
      <div style="flex:1;min-width:200px">
      <h4>Terminal 1</h4>
      <pre>[PUBLISH] Vibration: True
[SEND] BUZZ:ON</pre>
      </div>
      <div style="flex:1;min-width:200px">
      <h4>Terminal 2</h4>
      <pre>[EVENT] Vibration detected ‚Üí buzzer ON</pre>
      </div>
    </div>
        

        <script>
          document.addEventListener('DOMContentLoaded', ()=>{
            // Fade-in on scroll
            const io = new IntersectionObserver((entries, obs) => {
              entries.forEach(e => {
                if (e.isIntersecting) { e.target.classList.add('visible'); obs.unobserve(e.target); }
              });
            }, { threshold: 0.12 });
            document.querySelectorAll('.fade-in').forEach(el => io.observe(el));

            // Add copy buttons to all <pre>
            document.querySelectorAll('pre').forEach(pre => {
              const wrapper = document.createElement('div'); wrapper.className = 'pre-wrap';
              pre.parentNode.insertBefore(wrapper, pre);
              wrapper.appendChild(pre);
              const btn = document.createElement('button'); btn.className = 'copy-btn'; btn.type = 'button'; btn.textContent = 'Salin';
              wrapper.appendChild(btn);
              btn.addEventListener('click', async () => {
                try {
                  await navigator.clipboard.writeText(pre.innerText);
                  btn.textContent = 'Tersalin';
                  setTimeout(() => btn.textContent = 'Salin', 1200);
                } catch (err) { alert('Gagal menyalin ke clipboard'); }
              });
            });

            // Insert section icons before each h2 based on keywords
            const iconMap = {
              'Deskripsi': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="9" stroke="var(--accent)" stroke-width="1.6"/><path d="M12 8v5" stroke="var(--accent)" stroke-width="1.6" stroke-linecap="round"/><path d="M12 16h.01" stroke="var(--accent)" stroke-width="1.6" stroke-linecap="round"/></svg>',
              'Arsitektur': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 7h18" stroke="var(--accent)" stroke-width="1.6" stroke-linecap="round"/><path d="M6 11h12" stroke="var(--accent)" stroke-width="1.6" stroke-linecap="round"/><path d="M9 15h6" stroke="var(--accent)" stroke-width="1.6" stroke-linecap="round"/></svg>',
              'Cara Kerja': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2v4" stroke="var(--accent)" stroke-width="1.6" stroke-linecap="round"/><path d="M12 18v4" stroke="var(--accent)" stroke-width="1.6" stroke-linecap="round"/><path d="M4.5 6.5l3 3" stroke="var(--accent)" stroke-width="1.6" stroke-linecap="round"/><path d="M19.5 17.5l-3-3" stroke="var(--accent)" stroke-width="1.6" stroke-linecap="round"/></svg>',
              'Struktur': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 7h6v10H3zM15 7h6v10h-6zM9 3h6v6H9z" stroke="var(--accent)" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/></svg>',
              'Instalasi': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 3v12" stroke="var(--accent)" stroke-width="1.6" stroke-linecap="round"/><path d="M8 7l4-4 4 4" stroke="var(--accent)" stroke-width="1.6" stroke-linecap="round"/></svg>',
              'ESP8266': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="3" width="18" height="18" rx="2" stroke="var(--accent)" stroke-width="1.4"/><circle cx="12" cy="12" r="2" fill="var(--accent)"/></svg>',
              'ROS2': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 12h18" stroke="var(--accent)" stroke-width="1.6" stroke-linecap="round"/><path d="M12 3v18" stroke="var(--accent)" stroke-width="1.6" stroke-linecap="round"/></svg>',
              'Menjalankan': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 3v18l15-9L5 3z" stroke="var(--accent)" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>',
              'Kendala': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 9v4" stroke="var(--accent)" stroke-width="1.6" stroke-linecap="round"/><path d="M12 17h.01" stroke="var(--accent)" stroke-width="1.6" stroke-linecap="round"/><path d="M10 3h4l6 12H4L10 3z" stroke="var(--accent)" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>'
            };
            document.querySelectorAll('h2').forEach(h2 => {
              for (const key in iconMap) {
                if (h2.textContent.includes(key)) {
                  const span = document.createElement('span'); span.className = 'sec-icon'; span.innerHTML = iconMap[key];
                  h2.prepend(span);
                  break;
                }
              }
            });

            // Smooth scroll for TOC links
            document.querySelectorAll('.toc a, .toc-float a').forEach(a => {
              a.addEventListener('click', e => {
                e.preventDefault(); const id = a.getAttribute('href').slice(1); const el = document.getElementById(id);
                if (el) el.scrollIntoView({behavior:'smooth', block:'start'});
              });
            });
          });
        </script>

        <hr>
        <h2>Kendala Umum & Solusi</h2>
        <div class="table-wrap">
          <table class="issues">
            <thead><tr><th>Masalah</th><th>Penyebab</th><th>Solusi</th></tr></thead>
            <tbody>
              <tr><td data-label="Masalah">SerialException: Access Denied</td><td data-label="Penyebab">Port dipakai proses lain</td><td data-label="Solusi">Tutup / kill proses yang pakai COM</td></tr>
              <tr><td data-label="Masalah">SerialException: File Not Found</td><td data-label="Penyebab">Port COM berubah</td><td data-label="Solusi">Cek Device Manager, update COM</td></tr>
              <tr><td data-label="Masalah">Tidak ada data</td><td data-label="Penyebab">Baudrate salah</td><td data-label="Solusi">Pastikan 115200</td></tr>
            </tbody>
          </table>
        </div>

        <footer style="margin-top:16px;font-size:13px;color:var(--muted)">Robotika Medis ‚Äî Teknik Biomedis, Fakultas Teknologi Industri, Institut Teknologi Sumatera. (2025)</footer>
      </section>

      <!-- Quick Actions removed as requested -->
    </main>
  </div>

  <nav class="toc-float" aria-label="Daftar Isi">
    <a href="#desc">Deskripsi</a>
    <a href="#arch">Arsitektur</a>
    <a href="#howto">Cara Kerja</a>
    <a href="#install">Instalasi</a>
    <a href="#esp">ESP8266</a>
    <a href="#ros2">Kode ROS2</a>
    <a href="#run">Menjalankan</a>
  </nav>

  <script>
    function openInEditor(){
      // tries to open file via custom scheme; fallback just alert path
      try{window.open('file:///C:/pixi_ws/ros2_ws/src/vibration_system/README.html');}catch(e){alert('Buka file di: C:\\pixi_ws\\ros2_ws\\src\\vibration_system\\README.html');}
    }
    function copyToClipboard(id){
      const el = document.getElementById(id);
      if(!el) return;
      navigator.clipboard.writeText(el.innerText).then(()=>{
        const b=document.createElement('div');b.textContent='Tersalin!';b.style.position='fixed';b.style.right='18px';b.style.bottom='18px';b.style.background='var(--accent)';b.style.color='white';b.style.padding='8px 12px';b.style.borderRadius='8px';document.body.appendChild(b);setTimeout(()=>b.remove(),1200);
      });

      // staggered reveal for sections
      document.querySelectorAll('.content > *').forEach((el, i)=>{ el.classList.add('animate-stagger'); setTimeout(()=>{ el.classList.add('visible') }, 120*i); });

      // header shrink on scroll + toc appear
      const header = document.querySelector('header'); const tocFloat = document.querySelector('.toc-float');
      const onScroll = ()=>{
        if(window.scrollY>20) header.classList.add('scrolled'); else header.classList.remove('scrolled');
        if(window.scrollY>80 && tocFloat) tocFloat.classList.add('visible');
      };
      window.addEventListener('scroll', onScroll); onScroll();
    }
  </script>
</body>
</html>